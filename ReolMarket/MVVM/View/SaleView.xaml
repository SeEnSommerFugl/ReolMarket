<UserControl x:Class="ReolMarket.MVVM.View.SaleView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        mc:Ignorable="d"
        d:DesignWidth="1652" d:DesignHeight="1048">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/ReolMarket;component/MVVM/View/Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid Margin="16">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="12"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Left Column -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>  <!-- Row 1 filter bar -->
                <RowDefinition Height="12"/>    <!-- spacing -->
                <RowDefinition Height="*"/>     <!-- Row 2 -->
                <RowDefinition Height="12"/>    <!-- spacing -->
                <!--<RowDefinition Height="Auto"/>-->  <!-- Row 3 -->
            </Grid.RowDefinitions>

            <!-- Row 1: Top filter -->
            <Border Style="{StaticResource Card}">
                <DockPanel LastChildFill="True">
                    <!-- Højre knapper -->
                    <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                        <Button Content="Ryd filtre" Command="{Binding ClearFiltersCommand}"
                                Style="{StaticResource ButtonBase}" Height="34" Margin="12,0,0,0"/>
                        <Button Content="Opdater" Command="{Binding RefreshCommand}"
                                Style="{StaticResource ButtonPrimary}" Height="34" Margin="12,0,0,0"/>
                    </StackPanel>

                    <!-- Venstre label -->
                    <TextBlock DockPanel.Dock="Left" Text="Salg" Style="{StaticResource H1}"
                       VerticalAlignment="Center" Margin="0,0,12,0"/>

                    <!-- Midterfilter (wrap hvis smalt) -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Måned:" Style="{StaticResource LabelMuted}" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox ItemsSource="{Binding Months}"
                                SelectedItem="{Binding SelectedMonth, Mode=TwoWay}"
                                Height="34" Width="120" Margin="0,0,12,0"/>

                        <TextBlock Text="År:" Style="{StaticResource LabelMuted}" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox ItemsSource="{Binding Years.Items}"
                                SelectedItem="{Binding SelectedYear, Mode=TwoWay}"
                                Height="34" Width="100"/>
                        
                    </StackPanel>
                </DockPanel>
            </Border>

            <!-- Row 2: liste -->
            <DataGrid Grid.Row="2" ItemsSource="{Binding SaleView}"
                  Style="{StaticResource DataGridBase}">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Dato" Width="160"
                                Binding="{Binding Timestamp, StringFormat={}{0:dd/MM/yyyy - HH:mm}}"/>
                    <DataGridTextColumn Header="Reol" Width="80" Binding="{Binding BoothNumber}"/>
                    <DataGridTextColumn Header="Produkt" Width="*" Binding="{Binding ProductName}"/>
                    <DataGridTextColumn Header="Pris" Width="120" Binding="{Binding Price}"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- row 3 - Button --><!--
            <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Registrér salg" Style="{StaticResource ButtonPrimary}"
                  Command="{Binding RegisterSaleCommand}"/>
            </StackPanel>-->
        </Grid>

        <!-- Middle Column (spacing handled by ColumnDefinition) -->

        <!-- Right Column -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>  <!-- Registrer salg -->
                <RowDefinition Height="12"/>    <!-- spacing -->
                <RowDefinition Height="Auto"/>  <!-- Salgs-tal -->
                <RowDefinition Height="12"/>    <!-- spacing -->
                <RowDefinition Height="2*"/>    <!-- Udestående differencer -->
                <RowDefinition Height="12"/>    <!-- spacing -->
                <RowDefinition Height="*"/>     <!-- Reol-tal -->
            </Grid.RowDefinitions>

            <!-- Registrer salg (RecordSales)-->
            <Border Grid.Row="0" Style="{StaticResource Card}">
                <StackPanel>
                    <!-- Header -->
                    <DockPanel>
                    <TextBlock Text="Registrer salg" Style="{StaticResource H2}" 
                                       HorizontalAlignment="Center"/>
                    </DockPanel>

                    <!-- Reolnummer -->
                    <DockPanel>
                        <TextBlock Text="Reol" Style="{StaticResource TitleLeft}" Foreground="#CFE0FF" Width="270"/>
                    <TextBox Text="{Binding BoothNumber, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputRight}" Width="368"/>
                    </DockPanel>
                    
                    <!-- Produktnavn -->
                    <DockPanel>
                        <TextBlock Text="Produkt" Style="{StaticResource TitleLeft}" Foreground="#CFE0FF" Width="270"/>
                        <TextBox Text="{Binding ItemName, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputRight}" Width="368"/>
                    </DockPanel>
                    
                    <!-- Mængde/kvantitet -->
                    <DockPanel>
                        <TextBlock  Text="Antal" Style="{StaticResource TitleLeft}" Foreground="#CFE0FF" Width="270"/>
                        <TextBox Text="{Binding Quantity, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputRight}" Width="368"/>
                    </DockPanel>
                    
                    <!-- Pris -->
                    <DockPanel>
                        <TextBlock Text="Pris" Style="{StaticResource TitleLeft}" Foreground="#CFE0FF" Width="270"/>
                        <TextBox Text="{Binding ItemPrice, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputRight}" Width="368"/>
                    </DockPanel>
                    
                    <!--Betalingsmetode-->
                    <DockPanel>
                        <TextBlock Text="Betalingsmetode" Style="{StaticResource TitleLeft}" Foreground="#CFE0FF" Width="270"/>
                        <ComboBox ItemsSource="{Binding PaymentMethod}"
                              DisplayMemberPath="PaymentMethod"
                              SelectedItem="{Binding SelectedPayment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource ComboRight}" Width="368"/>
                    </DockPanel>

                    <Button Content="Registrér salg" Style="{StaticResource ButtonPrimary}"
                            Command="{Binding RegisterSaleCommand}"
                            Margin="10,10,10,0"/>

                    <DataGrid ItemsSource="{Binding RecordSales}"
                                      HeadersVisibility="None"
                                      GridLinesVisibility="None" 
                                      Background="Transparent" 
                                      BorderBrush="Transparent"
                                      Margin="0,8,0,0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Label}" Width="*" />
                            <DataGridTextColumn Binding="{Binding Value}" Width="140"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>

            <!-- Salgs-tal (SalesFigures) -->
            <!--<Border Grid.Row="2" Style="{StaticResource Card}">
                <StackPanel>
                    <TextBlock Text="Salgstal" Style="{StaticResource H2}" 
                                       HorizontalAlignment="Center"/>
                    <DataGrid  ItemsSource="{Binding SalesFigures}"
                                       HeadersVisibility="None"
                                       GridLinesVisibility="None" 
                                       Background="Transparent" 
                                       BorderBrush="Transparent"
                                       Margin="0,8,0,0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Label}" Width="*"/>
                            <DataGridTextColumn Binding="{Binding Value}" Width="140"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>-->

            <!-- Udestående differencer (OutstandingDifferences) -->
            <Border Grid.Row="4" Style="{StaticResource Card}">
                <StackPanel>
                    <TextBlock  Text="Udestående Differencer" Style="{StaticResource H2}" 
                                        HorizontalAlignment="Center"/>
                    <DataGrid   ItemsSource="{Binding OutstandingDifferences}"
                                        HeadersVisibility="None"
                                        GridLinesVisibility="None" 
                                        Background="Transparent" 
                                        BorderBrush="Transparent"
                                        Margin="0,8,0,0">
                        <DataGrid.Columns>
                            <DataGridTextColumn 
                                        Binding="{Binding RenterName}" 
                                        Width="*" />
                            <DataGridTextColumn 
                                        Binding="{Binding Amount}" 
                                        Width="140">
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>

            <!-- Reol-tal -->
            <Border Grid.Row="6" Style="{StaticResource Card}">
                <StackPanel>
                    <TextBlock  Text="Reol tal" Style="{StaticResource H2}" 
                                        HorizontalAlignment="Center"/>
                    <DataGrid   ItemsSource="{Binding BoothFigures}" 
                                        HeadersVisibility="None"
                                        GridLinesVisibility="None" 
                                        Background="Transparent" 
                                        BorderBrush="Transparent"
                                        Margin="0,8,0,0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Label}" Width="*" />
                            <DataGridTextColumn Binding="{Binding Value}" Width="140"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>
